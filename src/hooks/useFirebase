import { useEffect, useState } from "react";
import { getAuth, signInWithPopup, GoogleAuthProvider,signOut,onAuthStateChanged,createUserWithEmailAndPassword } from "firebase/auth";
import initializeAuthentication from "../components/firebase/firebase.int";



initializeAuthentication();


const useFirebase = () => {
    const [user,setUser] = useState({})

    const auth = getAuth();

   const  signUsingInGoogle = () => {
       const googleProvider = new GoogleAuthProvider();
        signInWithPopup(auth, googleProvider)
        .then(result =>{
           setUser(result.user)

        })
    }
    
   useEffect(()  =>   {
   const unsubscribe =  onAuthStateChanged(auth,user=>{
        if(user){
            setUser(user)

        }
    else{
        setUser({})
    }

    return () => unsubscribe;
        })
       
       },[])

    const logOut = () =>{
     signOut(auth)
     .then(() =>{

     })


    }

return{
    user,
    signUsingInGoogle,
    logOut
}

}


export default useFirebase;